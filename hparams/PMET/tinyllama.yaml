alg_name: "PMET"
model_name: "TinyLlama"
stats_dir: "./data/status"
device: 0
layers: [3, 4, 5]
clamp_norm_factor: 4
layer_selection: "all"
fact_token: "subject_last"
v_num_grad_steps: 20
v_lr: 5e-1
v_loss_layer: 21
v_weight_decay: 0.5
kl_factor: 0.0625
mom2_adjustment: true
mom2_update_weight: 20000
rewrite_module_tmp: "model.layers.{}.mlp.down_proj"
rewrite_module_tmps: ["model.layers.{}.mlp.down_proj"]
layer_module_tmp: "model.layers.{}"
mlp_module_tmp: "model.layers.{}.mlp.down_proj"
attn_module_tmp: "model.layers.{}.self_attn.o_proj"
ln_f_module: "model.norm"
lm_head_module: "lm_head"
mom2_dataset: "wikipedia"
mom2_n_samples: 100000
mom2_dtype: "float32"
model_parallel: false
nll_loss_factor: 1
model_parallel: false
attn_W_loss_weight: 0
attnW_droupout: 0
attn_K_loss_weight: 0
last_hid_restrain_weight: 0
last_hid_restrain_layers: None
high_attn_range: None
loss_type: KL